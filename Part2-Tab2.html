<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ramp Worker Ergonomics – Stakeholder Powers-of-Ten Table</title>
<style>
  :root {
    --bg: #ffffff;
    --fg: #1f2937; /* slate-800 */
    --muted: #6b7280; /* gray-500 */
    --brand: #0ea5e9; /* sky-500 */
    --accent: #e2f2fb;
    --border: #e5e7eb; /* gray-200 */
  }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; color: var(--fg); background: var(--bg); margin: 0; padding: 24px; }
  .page { max-width: 1100px; margin: 0 auto; }
  header { margin-bottom: 18px; }
  header h1 { margin: 0 0 6px; font-size: 1.6rem; }
  header p { margin: 4px 0; color: var(--muted); }
  .badge { display: inline-block; padding: 4px 8px; border-radius: 999px; background: var(--accent); color: #0369a1; font-weight: 600; font-size: 12px; margin-right: 8px; }
  .opportunity { background: #f8fafc; border: 1px solid var(--border); border-radius: 10px; padding: 12px 14px; margin: 14px 0 18px; }
  .opportunity strong { color: #0b5582; }
  table { width: 100%; border-collapse: collapse; border: 1px solid var(--border); }
  thead th { text-align: left; font-size: 0.9rem; color: #0b3d5c; border-bottom: 2px solid var(--border); padding: 10px; background: #f0f9ff; }
  tbody td { vertical-align: top; padding: 12px 10px; border-bottom: 1px solid var(--border); }
  tbody tr:nth-child(even) { background: #fcfdff; }
  .num { width: 44px; font-weight: 700; color: #0b3d5c; }
  .zoom { width: 160px; min-width: 140px; vertical-align: top; }
  .name { font-weight: 700; color: #0f172a; }
  .why { color: var(--muted); margin-top: 6px; line-height: 1.45; }
  footer { margin-top: 16px; font-size: 12px; color: var(--muted); }
  .legend { margin: 8px 0 18px; font-size: 0.92rem; color: var(--muted); }
  /* --- Sliders styling --- */
  .sliders { margin-top: 10px; border-top: 1px dashed var(--border); padding-top: 10px; }
  .slider-row { display: grid; grid-template-columns: 220px 1fr; align-items: center; gap: 10px; margin: 8px 0; }
  .slider-row label { font-weight: 600; color: #0b3d5c; }
  .slider-row .value { font-weight: 700; margin-left: 6px; color: var(--fg); }
  input[type=range] { width: 100%; }
  .micro-hint { font-size: 12px; color: var(--muted); margin-top: 4px; }
  /* Mini quadrant per-row */
  .zoomCell { display: flex; flex-direction: column; align-items: center; gap: 6px; }
  .zoomLabel { font-weight: 700; color: #0b3d5c; }
  .miniQuad { width: 100%; max-width: 130px; aspect-ratio: 1 / 1; }
  .miniQuad svg { width: 100%; height: 100%; display: block; }
  .miniQuad { cursor: crosshair; }
  .miniReset { appearance: none; border: 1px solid var(--border); background: #ffffff; color: #0b3d5c; font-size: 12px; padding: 4px 8px; border-radius: 6px; margin-top: 4px; cursor: pointer; }
  .miniReset:hover { background: #f0f9ff; border-color: #bae6fd; }
  @media (max-width: 700px){
    .zoom { width: 130px; min-width: 110px; }
    .slider-row { grid-template-columns: 160px 1fr; }
  }
  .note { background:#f8fafc; border:1px solid var(--border); border-radius:10px; padding:10px 12px; margin-bottom:10px; color: #0b3d5c; }
  .note { background:#f8fafc; border:1px solid var(--border); border-radius:10px; padding:10px 12px; margin-bottom:10px; color: #0b3d5c; }
  /* Big board */
  .boardWrap { margin-top: 18px; padding-top: 12px; border-top: 2px solid var(--border); }
  .boardTitle { font-weight: 800; color:#0b3d5c; margin: 0 0 8px; }
  .bigBoard { width: 100%; max-width: 900px; aspect-ratio: 1/1; border:1px solid var(--border); border-radius: 8px; background:#ffffff; }
  .bigBoard svg { width: 100%; height: 100%; display:block; touch-action: none; }
  .boardControls { display:flex; gap:10px; align-items:center; margin:10px 0 12px; }
  .boardReset { appearance:none; border:1px solid var(--border); background:#fff; color:#0b3d5c; font-weight:600; padding:6px 10px; border-radius:8px; cursor:pointer; }
  .boardReset:hover { background:#f0f9ff; border-color:#bae6fd; }
  .boardLegend { display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:8px; margin-top:10px; max-width: 900px; }
  .legendItem { display:flex; align-items:center; gap:8px; color:#334155; }
  .legendIcon { width:24px; height:24px; display:inline-block; }
</style>
</head>
<body>
  <div class="page">
    

    <div class="note"><strong>How to use:</strong>
  <ul style="margin:6px 0 0 18px; padding:0 0 0 4px;">
    <li>Each stakeholder starts with preset default values for <em>Interest</em> (X) and <em>Influence</em> (Y) — currently 50% unless changed later.</li>
    <li>Adjust values using the two horizontal sliders under the stakeholder description; the percentages update immediately.</li>
    <li>Or drag the dot inside the mini quadrant: left↔right changes <em>Interest</em>, up↕down changes <em>Influence</em>.</li>
    <li>Use <strong>Reset</strong> under a quadrant to return that stakeholder’s dot and sliders to its preset defaults. Reset affects only that row.</li>
  </ul>
</div>

<table>
      <caption style="caption-side: top; text-align:left; padding:8px 10px; font-weight:700; color:#0b3d5c;">Interest–Influence Map — dynamic (drag to adjust %)</caption>
      <thead>
        <tr>
          <th class="num">#</th>
          <th class="zoom">Zoom</th>
          <th>Stakeholder & Rationale</th>
        </tr>
      </thead>
      <tbody>
        <!-- 1 -->
        <tr>
          <td class="num">1</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Ramp workers / baggage handlers</div>
            <div class="why">Core users who lift, carry, twist, and work inside tight holds under time and weather pressure; they <em>embody</em> the ergonomic problem and are the first-order recipients of harm or benefit.</div>
          </td>
        </tr>
        <!-- 2 -->
        <tr>
          <td class="num">2</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Ground crew leads & safety trainers</div>
            <div class="why">Coordinate sequencing, enforce procedures, and set the practical pace/spacing that determines posture quality and micro-breaks; high leverage over safe technique adoption.</div>
          </td>
        </tr>
        <!-- 3 -->
        <tr>
          <td class="num">3</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Ramp operations ecosystem (fuelers, tug/vehicle operators, catering loaders)</div>
            <div class="why">Share space/time windows on the ramp; their arrival/departure sequencing drives peak load, congestion, and rushing that raises musculoskeletal risk.</div>
          </td>
        </tr>
        <!-- 4 -->
        <tr>
          <td class="num">4</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Operational control & load planning (ramp controller / dispatcher / load planner)</div>
            <div class="why">Set turnaround tempo and baggage flow; influence workload spikes, recovery time, and communication that mitigates or amplifies strain.</div>
          </td>
        </tr>
        <!-- 5 -->
        <tr>
          <td class="num">5</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Airline & ground-handling management</div>
            <div class="why">Own safety and on-time KPIs; decide staffing, training intensity, and investment in lift-assist/exoskeletons and analytics — critical for scale-up and sustained adoption.</div>
          </td>
        </tr>
        <!-- 6 -->
        <tr>
          <td class="num">6</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Airport authority (operations & safety office)</div>
            <div class="why">Controls ramp access, infrastructure, and site rules; can enable or constrain ergonomic equipment use, safe zones, and workflow improvements.</div>
          </td>
        </tr>
        <!-- 7 -->
        <tr>
          <td class="num">7</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Regulators (FAA, OSHA, IATA)</div>
            <div class="why">Define baggage weight limits, training/ergonomics standards, and reporting; compliance pressure raises influence over solution design and rollout.</div>
          </td>
        </tr>
        <!-- 8 -->
        <tr>
          <td class="num">8</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Passengers / public</div>
            <div class="why">Indirect beneficiaries whose expectations for timely, damage-free baggage shape reputation and economic incentives for safer, smoother operations.</div>
          </td>
        </tr>
        <!-- 9 -->
        <tr>
          <td class="num">9</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Occupational health clinicians & physical therapists</div>
            <div class="why">Treat WMSDs and provide rehab feedback; their injury data and guidance inform prevention targets (posture, repetition, torque) for product requirements.</div>
          </td>
        </tr>
        <!-- 10 -->
        <tr>
          <td class="num">10</td>
          <td class="zoom"><div class="zoomCell"><div class="miniQuad" aria-label="Quadrant preview"></div></div></td>
          <td>
            <div class="name">Workers’ compensation / injury insurance providers</div>
            <div class="why">Handle claims and total cost of injury; can create incentives or requirements for ergonomic interventions and track ROI at scale.</div>
          </td>
        </tr>
      </tbody></table>

    <section class="boardWrap">
      <h2 class="boardTitle">System Quadrant — All Stakeholders (drag to reposition)</h2>
      <div class="boardControls">
        <button type="button" class="boardReset" id="resetAll">Reset All to Defaults</button>
      </div>
      <div class="bigBoard" id="bigBoard" aria-label="All-stakeholders quadrant"></div>
      <div class="boardLegend" id="boardLegend" aria-label="Legend"></div>
    </section>

    <!-- Interactive Interest/Influence sliders injected under each stakeholder -->
    

    <template id="sliderTemplate">
      <div class="sliders" role="group" aria-label="Interest and Influence controls">
        <div class="slider-row">
          <label>Interest (X) <span class="value">50%</span></label>
          <input type="range" min="0" max="100" value="50" class="slider interest" aria-label="Interest (X)" />
        </div>
        <div class="slider-row">
          <label>Influence (Y) <span class="value">50%</span></label>
          <input type="range" min="0" max="100" value="50" class="slider influence" aria-label="Influence (Y)" />
        </div>
      </div>
    </template>

    <script>
  const svgns = 'http://www.w3.org/2000/svg';

  function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

  // --- Mini quadrants helpers ---
  function setDot(dot, interest, influence){
    const x = clamp(Number(interest), 0, 100);
    const y = 100 - clamp(Number(influence), 0, 100);
    dot.setAttribute('cx', x);
    dot.setAttribute('cy', y);
    dot.setAttribute('r', 4);
    dot.setAttribute('fill', '#0ea5e9');
  }

  function buildMiniQuad(container, interest, influence){
    const svg = document.createElementNS(svgns, 'svg');
    svg.setAttribute('viewBox', '0 0 100 100');
    svg.setAttribute('aria-hidden', 'true');

    const border = document.createElementNS(svgns, 'rect');
    border.setAttribute('x', 0); border.setAttribute('y', 0); border.setAttribute('width', 100); border.setAttribute('height', 100);
    border.setAttribute('fill', 'none'); border.setAttribute('stroke', '#cbd5e1');

    const v = document.createElementNS(svgns, 'line');
    v.setAttribute('x1', 50); v.setAttribute('y1', 0); v.setAttribute('x2', 50); v.setAttribute('y2', 100);
    v.setAttribute('stroke', '#94a3b8'); v.setAttribute('stroke-dasharray', '2,2');

    const h = document.createElementNS(svgns, 'line');
    h.setAttribute('x1', 0); h.setAttribute('y1', 50); h.setAttribute('x2', 100); h.setAttribute('y2', 50);
    h.setAttribute('stroke', '#94a3b8'); h.setAttribute('stroke-dasharray', '2,2');

    const dot = document.createElementNS(svgns, 'circle');
    dot.classList.add('dot');
    setDot(dot, interest, influence);

    svg.append(border, v, h, dot);
    container.innerHTML = '';
    container.appendChild(svg);
    return svg;
  }

  function attachMiniInteractions(mini, tr, syncGlobal){
    const svg = mini.querySelector('svg');
    const dot = svg.querySelector('.dot');
    const interestInput = tr.querySelector('input.interest');
    const influenceInput = tr.querySelector('input.influence');
    const interestLabel = tr.querySelector('.slider-row:nth-child(1) .value');
    const influenceLabel = tr.querySelector('.slider-row:nth-child(2) .value');

    let dragging = false;

    function setFromClient(clientX, clientY){
      const rect = svg.getBoundingClientRect();
      const xPct = clamp(((clientX - rect.left) / rect.width) * 100, 0, 100);
      const yPct = clamp(((clientY - rect.top) / rect.height) * 100, 0, 100);
      const interest = Math.round(xPct);
      const influence = Math.round(100 - yPct);
      tr.dataset.interest = interest;
      tr.dataset.influence = influence;
      setDot(dot, interest, influence);
      if(interestInput){ interestInput.value = interest; interestLabel.textContent = interest + '%'; }
      if(influenceInput){ influenceInput.value = influence; influenceLabel.textContent = influence + '%'; }
      syncGlobal(tr.dataset.id, interest, influence);
    }

    svg.addEventListener('pointerdown', (e) => {
      dragging = true;
      svg.setPointerCapture(e.pointerId);
      setFromClient(e.clientX, e.clientY);
    });
    svg.addEventListener('pointermove', (e) => {
      if(!dragging) return;
      setFromClient(e.clientX, e.clientY);
    });
    svg.addEventListener('pointerup', (e) => {
      dragging = false;
      try { svg.releasePointerCapture(e.pointerId); } catch(_){}
    });
    svg.addEventListener('pointercancel', () => { dragging = false; });
  }

  // --- Global board helpers ---
  function regularPolygonPoints(sides, r, rotationDeg){
    const pts = [];
    const rot = (Math.PI/180) * (rotationDeg || 0);
    for(let i=0;i<sides;i++){
      const a = rot + (i * 2*Math.PI / sides);
      pts.push((Math.cos(a)*r).toFixed(2) + ',' + (Math.sin(a)*r).toFixed(2));
    }
    return pts.join(' ');
  }

  function createShape(type){
    const g = document.createElementNS(svgns, 'g');
    g.setAttribute('tabindex', '0');
    g.style.cursor = 'grab';
    const r = 3.5; // base size in board units
    let el;
    switch(type){
      case 'circle':
        el = document.createElementNS(svgns, 'circle'); el.setAttribute('cx', 0); el.setAttribute('cy', 0); el.setAttribute('r', r);
        el.setAttribute('fill', '#0ea5e9'); break;
      case 'square':
        el = document.createElementNS(svgns, 'rect'); el.setAttribute('x', -r); el.setAttribute('y', -r); el.setAttribute('width', 2*r); el.setAttribute('height', 2*r);
        el.setAttribute('fill', '#0284c7'); break;
      case 'triangle':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', regularPolygonPoints(3, r, -90)); el.setAttribute('fill', '#38bdf8'); break;
      case 'triangleDown':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', regularPolygonPoints(3, r, 90)); el.setAttribute('fill', '#38bdf8'); break;
      case 'diamond':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', '0,'+(-r)+' '+r+',0 0,'+r+' '+(-r)+',0'); el.setAttribute('fill', '#06b6d4'); break;
      case 'pentagon':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', regularPolygonPoints(5, r, -90)); el.setAttribute('fill', '#0ea5e9'); break;
      case 'hexagon':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', regularPolygonPoints(6, r, 0)); el.setAttribute('fill', '#3b82f6'); break;
      case 'octagon':
        el = document.createElementNS(svgns, 'polygon'); el.setAttribute('points', regularPolygonPoints(8, r, 22.5)); el.setAttribute('fill', '#60a5fa'); break;
      case 'plus':
        el = document.createElementNS(svgns, 'g');
        const h = document.createElementNS(svgns, 'rect'); h.setAttribute('x', -r); h.setAttribute('y', -1.2); h.setAttribute('width', 2*r); h.setAttribute('height', 2.4); h.setAttribute('fill', '#0284c7');
        const v = document.createElementNS(svgns, 'rect'); v.setAttribute('x', -1.2); v.setAttribute('y', -r); v.setAttribute('width', 2.4); v.setAttribute('height', 2*r); v.setAttribute('fill', '#0284c7');
        el.append(h,v); break;
      case 'cross':
        el = document.createElementNS(svgns, 'g');
        const l1 = document.createElementNS(svgns, 'line'); l1.setAttribute('x1', -r); l1.setAttribute('y1', -r); l1.setAttribute('x2', r); l1.setAttribute('y2', r); l1.setAttribute('stroke', '#0c4a6e'); l1.setAttribute('stroke-width', 2);
        const l2 = document.createElementNS(svgns, 'line'); l2.setAttribute('x1', -r); l2.setAttribute('y1', r); l2.setAttribute('x2', r); l2.setAttribute('y2', -r); l2.setAttribute('stroke', '#0c4a6e'); l2.setAttribute('stroke-width', 2);
        el.append(l1,l2); break;
      default:
        el = document.createElementNS(svgns, 'circle'); el.setAttribute('cx', 0); el.setAttribute('cy', 0); el.setAttribute('r', r); el.setAttribute('fill', '#0ea5e9');
    }
    g.appendChild(el);
    return g;
  }

  function buildBoard(container){
    const svg = document.createElementNS(svgns, 'svg');
    svg.setAttribute('viewBox', '0 0 100 100');

    // grid
    const border = document.createElementNS(svgns, 'rect');
    border.setAttribute('x', 0); border.setAttribute('y', 0); border.setAttribute('width', 100); border.setAttribute('height', 100);
    border.setAttribute('fill', 'none'); border.setAttribute('stroke', '#94a3b8');

    const v = document.createElementNS(svgns, 'line');
    v.setAttribute('x1', 50); v.setAttribute('y1', 0); v.setAttribute('x2', 50); v.setAttribute('y2', 100);
    v.setAttribute('stroke', '#94a3b8'); v.setAttribute('stroke-dasharray', '3,3');

    const h = document.createElementNS(svgns, 'line');
    h.setAttribute('x1', 0); h.setAttribute('y1', 50); h.setAttribute('x2', 100); h.setAttribute('y2', 50);
    h.setAttribute('stroke', '#94a3b8'); h.setAttribute('stroke-dasharray', '3,3');

    svg.append(border, v, h);
    container.innerHTML = ''; container.appendChild(svg);
    return svg;
  }

  const SHAPE_FOR_ID = {
    1:'circle', 2:'square', 3:'triangle', 4:'diamond', 5:'pentagon',
    6:'hexagon', 7:'triangleDown', 8:'octagon', 9:'plus', 10:'cross'
  };

  // Default values per stakeholder (1..10). Set to numbers 0–100; leave null to use 50 as placeholder.
  const DEFAULTS = {
    1: { interest: null, influence: null }, // Ramp workers / baggage handlers
    2: { interest: null, influence: null }, // Ground crew leads & safety trainers
    3: { interest: null, influence: null }, // Ramp operations ecosystem
    4: { interest: null, influence: null }, // Operational control & load planning
    5: { interest: null, influence: null }, // Airline & ground-handling management
    6: { interest: null, influence: null }, // Airport authority
    7: { interest: null, influence: null }, // Regulators (FAA, OSHA, IATA)
    8: { interest: null, influence: null }, // Passengers / public
    9: { interest: null, influence: null }, // Occupational health clinicians & PTs
    10:{ interest: null, influence: null }  // Workers’ comp / injury insurance
  };

  document.addEventListener('DOMContentLoaded', () => {
    const rows = document.querySelectorAll('tbody tr');
    const tmpl = document.getElementById('sliderTemplate');
    const boardEl = document.getElementById('bigBoard');
    const legendEl = document.getElementById('boardLegend');
    const resetAllBtn = document.getElementById('resetAll');

    // --- init rows (sliders + mini-quads)
    rows.forEach((tr, i) => {
      const id = i + 1; // 1..10
      tr.dataset.id = id;
      const stakeholderCell = tr.children[2];
      const node = tmpl.content.cloneNode(true);

      const interestInput = node.querySelector('input.interest');
      const influenceInput = node.querySelector('input.influence');
      const values = node.querySelectorAll('.value');
      const interestDefault = (DEFAULTS[id]?.interest ?? 50);
      const influenceDefault = (DEFAULTS[id]?.influence ?? 50);

      interestInput.value = interestDefault;
      influenceInput.value = influenceDefault;
      values[0].textContent = interestDefault + '%';
      values[1].textContent = influenceDefault + '%';

      // Persist
      tr.dataset.interest = interestDefault;
      tr.dataset.influence = influenceDefault;

      stakeholderCell.appendChild(node);

      // Build mini quad
      const mini = tr.children[1].querySelector('.miniQuad');
      const miniSvg = buildMiniQuad(mini, interestDefault, influenceDefault);

      // We'll define syncGlobal later after board exists
      function placeholderSync(){/* replaced later */}
      attachMiniInteractions(mini, tr, (...args)=>syncGlobal(...args));

      // Slider sync -> mini + global
      const interestEl = tr.querySelector('input.interest');
      const influenceEl = tr.querySelector('input.influence');
      const vInterest = tr.querySelector('.slider-row:nth-child(1) .value');
      const vInfluence = tr.querySelector('.slider-row:nth-child(2) .value');

      function updateFromSliders(){
        const iVal = Number(interestEl.value);
        const yVal = Number(influenceEl.value);
        tr.dataset.interest = iVal;
        tr.dataset.influence = yVal;
        setDot(miniSvg.querySelector('.dot'), iVal, yVal);
        vInterest.textContent = iVal + '%';
        vInfluence.textContent = yVal + '%';
        syncGlobal(tr.dataset.id, iVal, yVal);
      }

      interestEl.addEventListener('input', updateFromSliders);
      influenceEl.addEventListener('input', updateFromSliders);

      // Per-row Reset under mini
      const zoomCell = tr.children[1].querySelector('.zoomCell');
      const btn = document.createElement('button');
      btn.type = 'button'; btn.className = 'miniReset'; btn.textContent = 'Reset';
      btn.addEventListener('click', () => {
        const dI = (DEFAULTS[id]?.interest ?? 50);
        const dY = (DEFAULTS[id]?.influence ?? 50);
        interestEl.value = dI; influenceEl.value = dY; updateFromSliders();
      });
      zoomCell.appendChild(btn);
    });

    // --- build big board and legend
    const boardSvg = buildBoard(boardEl);

    // create groups for each stakeholder
    const groupsById = {};
    rows.forEach((tr, i) => {
      const id = i + 1;
      const shape = SHAPE_FOR_ID[id] || 'circle';
      const g = createShape(shape);
      g.dataset.id = id;
      groupsById[id] = g;
      boardSvg.appendChild(g);
    });

    function setGroupPos(id, interest, influence){
      const g = groupsById[id];
      if(!g) return;
      const x = clamp(Number(interest),0,100);
      const y = 100 - clamp(Number(influence),0,100);
      g.setAttribute('transform', `translate(${x},${y})`);
    }

    // initial positions
    rows.forEach((tr, i) => {
      const id = i + 1;
      setGroupPos(id, tr.dataset.interest, tr.dataset.influence);
    });

    // legend
    legendEl.innerHTML = '';
    rows.forEach((tr, i) => {
      const id = i + 1;
      const label = tr.querySelector('.name').textContent.trim();
      const wrap = document.createElement('div'); wrap.className = 'legendItem';
      const icon = document.createElementNS(svgns, 'svg'); icon.setAttribute('viewBox','-12 -12 24 24'); icon.classList.add('legendIcon');
      const iconShape = createShape(SHAPE_FOR_ID[id] || 'circle');
      iconShape.setAttribute('transform','translate(0,0)');
      icon.appendChild(iconShape.firstChild.cloneNode(true));
      const span = document.createElement('span'); span.textContent = label;
      wrap.append(icon, span);
      legendEl.appendChild(wrap);
    });

    // Sync functions between table and board
    function syncGlobal(id, interest, influence){
      setGroupPos(id, interest, influence);
    }

    function syncRowFromBoard(id, interest, influence){
      const index = Number(id) - 1;
      const tr = rows[index];
      tr.dataset.interest = interest; tr.dataset.influence = influence;
      // sliders
      const interestEl = tr.querySelector('input.interest');
      const influenceEl = tr.querySelector('input.influence');
      const vInterest = tr.querySelector('.slider-row:nth-child(1) .value');
      const vInfluence = tr.querySelector('.slider-row:nth-child(2) .value');
      if(interestEl){ interestEl.value = interest; vInterest.textContent = interest + '%'; }
      if(influenceEl){ influenceEl.value = influence; vInfluence.textContent = influence + '%'; }
      // mini
      const miniSvg = tr.children[1].querySelector('.miniQuad svg');
      if(miniSvg){ setDot(miniSvg.querySelector('.dot'), interest, influence); }
    }

    // drag interactions on board
    let draggingId = null;
    function boardSetFromClient(id, clientX, clientY){
      const rect = boardSvg.getBoundingClientRect();
      const xPct = clamp(((clientX - rect.left) / rect.width) * 100, 0, 100);
      const yPct = clamp(((clientY - rect.top) / rect.height) * 100, 0, 100);
      const interest = Math.round(xPct);
      const influence = Math.round(100 - yPct);
      syncRowFromBoard(id, interest, influence);
      setGroupPos(id, interest, influence);
    }

    Object.values(groupsById).forEach(g => {
      g.addEventListener('pointerdown', (e) => {
        draggingId = g.dataset.id;
        g.style.cursor = 'grabbing';
        boardSvg.setPointerCapture(e.pointerId);
        boardSetFromClient(draggingId, e.clientX, e.clientY);
      });
    });

    boardSvg.addEventListener('pointermove', (e) => {
      if(!draggingId) return;
      boardSetFromClient(draggingId, e.clientX, e.clientY);
    });
    boardSvg.addEventListener('pointerup', (e) => {
      if(!draggingId) return;
      const g = groupsById[draggingId]; if(g) g.style.cursor = 'grab';
      draggingId = null;
      try { boardSvg.releasePointerCapture(e.pointerId);} catch(_){}
    });
    boardSvg.addEventListener('pointercancel', () => { draggingId = null; });

    // Reset all
    resetAllBtn.addEventListener('click', () => {
      rows.forEach((tr, i) => {
        const id = i + 1;
        const dI = (DEFAULTS[id]?.interest ?? 50);
        const dY = (DEFAULTS[id]?.influence ?? 50);
        syncRowFromBoard(id, dI, dY);
        setGroupPos(id, dI, dY);
      });
    });
  });
</script>

    
  </div>
</body>
</html>
